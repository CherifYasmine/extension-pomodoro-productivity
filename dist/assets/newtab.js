import{j as o,r as m,a as j,b as v,n as k,p as N,c as y,C,s as w,d as _,e as D,f as B,g as P,h as A}from"./pomodoroLogic-DCs9eqyV.js";const E="_modalOverlay_pabgz_1",z="_modalContent_pabgz_12",L="_heading_pabgz_23",T="_form_pabgz_31",F="_label_pabgz_37",O="_input_pabgz_45",I="_saveBtn_pabgz_59",M="_closeBtn_pabgz_76",c={modalOverlay:E,modalContent:z,heading:L,form:T,label:F,input:O,saveBtn:I,closeBtn:M},R=({open:t,durations:e,setDurations:l,onClose:n,name:p="",setName:g})=>t?o.jsx("div",{className:c.modalOverlay,onClick:n,children:o.jsxs("div",{className:c.modalContent,onClick:s=>s.stopPropagation(),children:[o.jsx("h2",{className:c.heading,children:"Pomodoro Settings"}),o.jsxs("form",{className:c.form,onSubmit:s=>{s.preventDefault(),n(),chrome.storage.local.set({pomodoroDurations:e,userName:p})},children:[g&&o.jsxs("label",{className:c.label,children:["Name:",o.jsx("input",{className:c.input,type:"text",value:p,onChange:s=>g(s.target.value),placeholder:"Your name"})]}),o.jsxs("label",{className:c.label,children:["Focus (minutes):",o.jsx("input",{className:c.input,type:"number",min:1,max:120,value:e.focus,onChange:s=>l({...e,focus:Number(s.target.value)})})]}),o.jsxs("label",{className:c.label,children:["Break (minutes):",o.jsx("input",{className:c.input,type:"number",min:1,max:60,value:e.break,onChange:s=>l({...e,break:Number(s.target.value)})})]}),o.jsxs("label",{className:c.label,children:["Long Break (minutes):",o.jsx("input",{className:c.input,type:"number",min:1,max:60,value:e.long,onChange:s=>l({...e,long:Number(s.target.value)})})]}),o.jsx("button",{type:"submit",className:c.saveBtn,children:"Save"})]}),o.jsx("button",{onClick:n,className:c.closeBtn,title:"Close",children:"×"})]})}):null,V=({percent:t,time:e,label:l})=>o.jsxs("div",{className:"pomodoro-circle",children:[o.jsxs("svg",{children:[o.jsx("circle",{cx:"50%",cy:"50%",r:"48%",stroke:"#fff4",strokeWidth:"6%",fill:"none"}),o.jsx("circle",{cx:"50%",cy:"50%",r:"48%",stroke:"#fff",strokeWidth:"6%",fill:"none",strokeDasharray:Math.PI*2*48,strokeDashoffset:Math.PI*2*48*(1-t),style:{transition:"stroke-dashoffset 0.5s"}})]}),o.jsxs("div",{className:"pomodoro-circle-time",children:[e,o.jsx("div",{style:{fontSize:"1vw",fontWeight:400,opacity:.7},children:l})]})]}),G={phase:"idle",endsAt:null,running:!1,cycle:0},$=({durations:t})=>{const[e,l]=m.useState(G);m.useEffect(()=>{j(a=>l(a));const d=a=>{a.pomodoroState&&a.pomodoroState.newValue&&l(a.pomodoroState.newValue)};return chrome.storage.onChanged.addListener(d),()=>chrome.storage.onChanged.removeListener(d)},[]),m.useEffect(()=>{if(!e.running||!e.endsAt)return;const d=setInterval(()=>{const a=v(e,k(t));a?n(a):l(S=>({...S}))},1e3);return()=>clearInterval(d)},[e,t]);const n=d=>{l(d),N(d)},p=()=>n(w(e,k(t))),g=()=>n(_({...e,phase:"focus"},k(t))),s=()=>n(B(e)),u=()=>n(P(e)),b=()=>n(D()),r=e.running&&e.endsAt?Math.max(0,Math.floor((e.endsAt-Date.now())/1e3)):e.pausedAt?Math.floor(e.pausedAt/1e3):e.phase==="focus"?t.focus*60:e.phase==="break"?t.break*60:t.long*60,i=e.phase==="focus"?r/(t.focus*60):e.phase==="break"?r/(t.break*60):e.phase==="long-break"?r/(t.long*60):0,h=`${String(Math.floor(r/60)).padStart(2,"0")}:${String(r%60).padStart(2,"0")}`,x=y(e);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"pomodoro-tabs",children:[o.jsx("div",{className:"pomodoro-tab"+(e.phase==="focus"?" active":""),onClick:()=>{e.phase!=="focus"&&p()},children:"FOCUS"}),o.jsx("div",{className:"pomodoro-tab"+(e.phase==="break"?" active":""),onClick:()=>{e.phase!=="break"&&g()},children:"BREAK"})]}),o.jsx(V,{percent:i,time:h,label:e.phase==="focus"?"Focus":e.phase==="break"?"Break":"Long Break"}),o.jsxs("div",{style:{display:"flex",gap:"1em",justifyContent:"center"},children:[o.jsx("button",{className:"newtab-focus-btn",style:{background:"#b91c1c",marginTop:"1em"},onClick:b,children:"Stop"}),e.running&&o.jsx("button",{className:"newtab-focus-btn",style:{background:"#f59e42",marginTop:"1em"},onClick:s,children:"Pause"}),!e.running&&e.pausedAt&&o.jsx("button",{className:"newtab-focus-btn",style:{background:"#2563eb",marginTop:"1em"},onClick:u,children:"Resume"})]}),o.jsxs("div",{style:{marginTop:"1em",fontSize:"1.2vw",opacity:.7},children:["Cycle: ",x,"/",C," ",e.phase==="long-break"&&"(Long Break)"]})]})},W=({durations:t,time:e,name:l,mainTask:n,editTask:p,setMainTask:g,setEditTask:s})=>{const[u,b]=m.useState(null);return m.useEffect(()=>{chrome.storage.local.get(["pomodoroState"],i=>{i.pomodoroState&&b(i.pomodoroState)});const r=i=>{i.pomodoroState&&i.pomodoroState.newValue&&b(i.pomodoroState.newValue)};return chrome.storage.onChanged.addListener(r),()=>chrome.storage.onChanged.removeListener(r)},[]),u&&(u.running||!u.running&&u.pausedAt!=null&&u.phase!=="idle")?o.jsx($,{durations:t}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"newtab-time",children:[e.getHours().toString().padStart(2,"0"),":",e.getMinutes().toString().padStart(2,"0")]}),o.jsx("div",{className:"newtab-greeting",children:K(l||"")}),o.jsx("div",{className:"newtab-task-label",children:"What is your main focus for today?"}),p?o.jsx("input",{className:"newtab-task-input",value:n,autoFocus:!0,onChange:r=>g(r.target.value),onBlur:()=>{s(!1),chrome.storage.local.set({mainTask:{text:n,done:!1}})},onKeyDown:r=>{r.key==="Enter"&&(s(!1),chrome.storage.local.set({mainTask:{text:n,done:!1}}))}}):o.jsx("input",{className:"newtab-task-input",value:n,readOnly:!0,onClick:()=>s(!0)}),o.jsx("button",{className:"newtab-focus-btn",onClick:()=>{const i={phase:"focus",running:!0,endsAt:Date.now()+t.focus*60*1e3,cycle:u&&typeof u.cycle=="number"?u.cycle:0};chrome.storage.local.set({pomodoroState:i})},children:"Start Focus"})]})};function K(t){const e=new Date().getHours();return e<12?`Good morning, ${t}.`:e<18?`Good afternoon, ${t}.`:`Good evening, ${t}.`}const f={focus:25,break:5,long:15},H=()=>{const[t,e]=m.useState(""),[l,n]=m.useState(""),[p,g]=m.useState(!1),[s,u]=m.useState(new Date),[b,r]=m.useState(!1),[i,h]=m.useState(f);return m.useEffect(()=>{const x=setInterval(()=>u(new Date),1e3);chrome.storage.local.get(["userName","mainTask","pomodoroDurations"],a=>{a.userName&&e(a.userName),a.mainTask&&n(a.mainTask.text||""),a.pomodoroDurations&&h({focus:Number(a.pomodoroDurations.focus)||f.focus,break:Number(a.pomodoroDurations.break)||f.break,long:Number(a.pomodoroDurations.long)||f.long})});const d=a=>{a.pomodoroDurations&&a.pomodoroDurations.newValue&&h({focus:Number(a.pomodoroDurations.newValue.focus)||f.focus,break:Number(a.pomodoroDurations.newValue.break)||f.break,long:Number(a.pomodoroDurations.newValue.long)||f.long})};return chrome.storage.onChanged.addListener(d),()=>{clearInterval(x),chrome.storage.onChanged.removeListener(d)}},[]),o.jsxs("div",{className:"newtab-center",children:[o.jsx("button",{style:{position:"absolute",top:24,left:24,zIndex:10,background:"#ccc",border:"none",borderRadius:40,width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"1.5em",color:"#fff"},onClick:()=>r(!0),title:"Settings",children:o.jsx("span",{role:"img","aria-label":"settings",children:"⚙️"})}),o.jsx(R,{open:b,durations:i,setDurations:h,onClose:()=>r(!1),name:t,setName:e}),o.jsx(W,{durations:i,time:s,name:t,mainTask:l,editTask:p,setMainTask:n,setEditTask:g})]})};A.createRoot(document.getElementById("root")).render(o.jsx(H,{}));
