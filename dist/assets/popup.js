import{r as a,j as t,n as k,a as g,b as N,c as y,C as D,p as E,s as T,d as w,e as A,f as L,g as B,h as I}from"./pomodoroLogic-BSaq9K96.js";const M=()=>{const[e,s]=a.useState(new Date);a.useEffect(()=>{const r=setInterval(()=>s(new Date),1e3);return()=>clearInterval(r)},[]);const c=e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});return t.jsx("div",{className:"clock","aria-label":"current time",children:c})};function G(){const e=new Date().getHours();return e<12?"Good morning":e<18?"Good afternoon":"Good evening"}const F=({name:e,onSave:s})=>{const[c,r]=a.useState(!e),[d,l]=a.useState(e||""),o=()=>{d.trim()&&(s(d.trim()),r(!1))};return t.jsx("div",{className:"greeting",children:c?t.jsxs("div",{className:"name-form",children:[t.jsx("input",{placeholder:"Your name",value:d,onChange:m=>l(m.target.value),onKeyDown:m=>m.key==="Enter"&&o()}),t.jsx("button",{onClick:o,children:"Save"})]}):t.jsxs("h1",{onDoubleClick:()=>r(!0),children:[G()," ",e]})})},R=()=>{const[e,s]=a.useState({text:"",done:!1}),[c,r]=a.useState(!0);a.useEffect(()=>{chrome.storage.local.get(["mainTask"],o=>{o&&o.mainTask&&(s(o.mainTask),r(!1))})},[]);const d=()=>{e.text.trim()&&(chrome.storage.local.set({mainTask:e}),r(!1))},l=()=>{const o={...e,done:!e.done};s(o),chrome.storage.local.set({mainTask:o})};return t.jsxs("div",{className:"main-task",children:[t.jsx("h2",{children:"Main Task Today"}),c?t.jsxs("div",{className:"task-edit",children:[t.jsx("input",{placeholder:"What is the one thing you'll do today?",value:e.text,onChange:o=>s({...e,text:o.target.value}),onKeyDown:o=>o.key==="Enter"&&d()}),t.jsx("button",{onClick:d,children:"Save"})]}):t.jsx("div",{className:"task-view",onDoubleClick:()=>r(!0),children:t.jsxs("label",{className:e.done?"done":"",children:[t.jsx("input",{type:"checkbox",checked:e.done,onChange:l})," ",e.text]})})]})},O={phase:"idle",endsAt:null,running:!1,cycle:0};function P(e){const s=Math.max(0,Math.floor(e/1e3)),c=Math.floor(s/60).toString().padStart(2,"0"),r=(s%60).toString().padStart(2,"0");return`${c}:${r}`}const V=()=>{const[e,s]=a.useState(O),[c,r]=a.useState(0),[d,l]=a.useState(!1),[o,m]=a.useState(k(null));a.useEffect(()=>{const n=setInterval(()=>r(i=>i+1),1e3);g((i,h)=>{s(i),m(h)});const p=i=>{i.pomodoroState&&i.pomodoroState.newValue&&s(i.pomodoroState.newValue),i.pomodoroDurations&&i.pomodoroDurations.newValue&&m(k(i.pomodoroDurations.newValue))};return chrome.storage.onChanged.addListener(p),()=>{clearInterval(n),chrome.storage.onChanged.removeListener(p)}},[]);const u=n=>{E(n),s(n)},f=a.useCallback(n=>{g((p,i)=>{let h=p;if(n==="focus")u(T(h,i));else if(n==="break"){const b={...h,phase:"focus"},C=w(b,i);u({...C,phase:"break"})}else u({...h,phase:"long-break",running:!0,pausedAt:null,endsAt:Date.now()+i.long*60*1e3})})},[]),j=()=>u(A()),S=()=>g(n=>{n.phase!=="idle"&&u(L(n))}),v=()=>g(n=>{n.phase!=="idle"&&u(B(n))});a.useEffect(()=>{if(!e.running||!e.endsAt)return;const n=N(e,o);n&&u(n)},[e,c,o]);const x=e.running&&e.endsAt?e.endsAt-Date.now():e.pausedAt||0;return t.jsxs("div",{className:"pomodoro",children:[t.jsx("h2",{children:"Focus Mode"}),t.jsx("div",{className:"status",children:e.phase==="idle"?"Idle":e.phase==="focus"?"Work":e.phase==="break"?"Short Break":"Long Break"}),t.jsx("div",{className:"time",children:e.running&&x>0||e.pausedAt?P(x):"--:--"}),t.jsxs("div",{className:"controls",children:[e.phase==="idle"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>f("focus"),children:"Start Work"}),t.jsx("button",{onClick:()=>f("break"),children:"Short Break"}),t.jsx("button",{onClick:()=>f("long-break"),children:"Long Break"})]}),e.phase!=="idle"&&e.running&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:j,children:"Stop"}),t.jsx("button",{onClick:S,children:"Pause"})]}),e.phase!=="idle"&&!e.running&&e.pausedAt!=null&&t.jsx("button",{onClick:v,children:"Resume"})]}),t.jsx("div",{className:"meta",children:`Cycle: ${y(e)}/${D}`})]})},$=()=>{const[e,s]=a.useState(""),[c,r]=a.useState(!1);a.useEffect(()=>{chrome.storage.local.get(["userName"],l=>{l&&l.userName&&s(l.userName),r(!0)})},[]);const d=l=>{s(l),chrome.storage.local.set({userName:l})};return c?t.jsxs("div",{className:"container",children:[t.jsx(M,{}),t.jsx(F,{name:e,onSave:d}),t.jsx(R,{}),t.jsx(V,{})]}):t.jsx("div",{className:"loading",children:"Loading..."})};I(document.getElementById("root")).render(t.jsx($,{}));
